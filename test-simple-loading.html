<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Video Load Test</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #000; color: #0f0; }
        pre { background: #111; padding: 10px; border: 1px solid #333; }
        .error { color: #f00; }
        .success { color: #0f0; }
    </style>
</head>
<body>
    <h1>Simple Video Load Test</h1>
    <div id="output"></div>

    <script>
        const output = document.getElementById('output');

        async function test() {
            output.innerHTML += '<p>üß™ Testing API...</p>';

            try {
                // Test 1: Basic API call
                output.innerHTML += '<p>üì° Fetching /api/videos?includeTranscript=true</p>';
                const response = await fetch('/api/videos?includeTranscript=true');
                const data = await response.json();

                output.innerHTML += `<p class="success">‚úÖ API Response received</p>`;
                output.innerHTML += `<pre>${JSON.stringify({
                    success: data.success,
                    count: data.count,
                    videosIsArray: Array.isArray(data.videos),
                    videosLength: data.videos ? data.videos.length : 0,
                    firstVideo: data.videos && data.videos[0] ? {
                        id: data.videos[0].id,
                        title: data.videos[0].title,
                        videoUrl: data.videos[0].videoUrl,
                        level: data.videos[0].level
                    } : null
                }, null, 2)}</pre>`;

                // Test 2: Check if videos have required fields
                if (data.videos && data.videos.length > 0) {
                    const video = data.videos[0];
                    const hasTranscription = video.transcription && video.transcription.lines && video.transcription.lines.length > 0;

                    output.innerHTML += `<p class="success">üìπ First video check:</p>`;
                    output.innerHTML += `<pre>Has videoUrl: ${!!video.videoUrl}
Has transcription: ${hasTranscription}
Video URL: ${video.videoUrl}</pre>`;
                }

            } catch (error) {
                output.innerHTML += `<p class="error">‚ùå Error: ${error.message}</p>`;
                output.innerHTML += `<pre>${error.stack}</pre>`;
            }
        }

        test();
    </script>
</body>
</html>
