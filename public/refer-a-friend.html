<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÅ Refer a Friend - Get Premium Free</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            color: white;
            font-size: 24px;
            font-weight: 700;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
        }

        .hero {
            background: white;
            border-radius: 24px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
        }

        .hero-icon {
            font-size: 80px;
            margin-bottom: 16px;
        }

        .hero-title {
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 16px;
        }

        .hero-subtitle {
            font-size: 20px;
            color: #666;
            margin-bottom: 32px;
        }

        .benefits {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 32px;
        }

        .benefit {
            background: #f8f9fa;
            padding: 24px;
            border-radius: 16px;
            text-align: left;
        }

        .benefit-icon {
            font-size: 40px;
            margin-bottom: 12px;
        }

        .benefit-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .benefit-text {
            font-size: 14px;
            color: #666;
        }

        .referral-link-section {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 32px;
            border-radius: 16px;
            margin-bottom: 32px;
        }

        .referral-link-title {
            color: white;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 16px;
            text-align: center;
        }

        .link-container {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .link-input {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            background: white;
        }

        .copy-btn {
            padding: 16px 32px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .copy-btn:hover {
            background: white;
            color: #667eea;
        }

        .share-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        .share-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 16px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .share-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .share-icon {
            font-size: 24px;
        }

        .stats {
            background: white;
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 20px;
        }

        .stats-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 24px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .stat-box {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 8px;
        }

        .leaderboard {
            background: white;
            border-radius: 16px;
            padding: 32px;
        }

        .leaderboard-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 24px;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 12px;
            margin-bottom: 12px;
        }

        .rank {
            font-size: 24px;
            font-weight: 700;
            margin-right: 16px;
            min-width: 40px;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .user-referrals {
            font-size: 14px;
            color: #666;
        }

        .reward {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .benefits {
                grid-template-columns: 1fr;
            }
            
            .share-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>

    <!-- Sentry Error Tracking -->
    <meta name="sentry-dsn" content="">
    <meta name="sentry-environment" content="production">
    <meta name="sentry-traces-sample-rate" content="0.1">
    <meta name="app-version" content="1.0.0">
    <script>
    // Load Sentry AFTER page is fully interactive
    window.addEventListener('load', function() {
        setTimeout(function() {
            var script = document.createElement('script');
            script.src = '/lib/sentry-client.js';
            script.defer = true;
            document.head.appendChild(script);
        }, 2000); // Load 2 seconds after page load
    });
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">üéÅ Refer a Friend</div>
            <button class="back-btn" onclick="goBack()">‚Üê Back</button>
        </div>

        <div class="hero">
            <div class="hero-icon">üéÅ</div>
            <h1 class="hero-title">Give Premium, Get Premium</h1>
            <p class="hero-subtitle">Invite friends and you both get 7 days of Premium free!</p>

            <div class="benefits">
                <div class="benefit">
                    <div class="benefit-icon">‚ú®</div>
                    <div class="benefit-title">Your Friend Gets</div>
                    <div class="benefit-text">7 days of Premium free when they sign up</div>
                </div>
                <div class="benefit">
                    <div class="benefit-icon">üéâ</div>
                    <div class="benefit-title">You Get</div>
                    <div class="benefit-text">7 days of Premium free for each friend</div>
                </div>
                <div class="benefit">
                    <div class="benefit-icon">üèÜ</div>
                    <div class="benefit-title">Refer 3 Friends</div>
                    <div class="benefit-text">Get 1 full month of Premium free!</div>
                </div>
                <div class="benefit">
                    <div class="benefit-icon">üëë</div>
                    <div class="benefit-title">Top Referrer</div>
                    <div class="benefit-text">Get lifetime Premium for free!</div>
                </div>
            </div>

            <div class="referral-link-section">
                <div class="referral-link-title">Your Unique Referral Link</div>
                <div class="link-container">
                    <input type="text" class="link-input" id="referralLink" readonly>
                    <button class="copy-btn" onclick="copyLink(event)">üìã Copy</button>
                </div>
                
                <div class="share-buttons">
                    <button class="share-btn" onclick="shareOn('whatsapp')">
                        <span class="share-icon">üí¨</span>
                        <span>WhatsApp</span>
                    </button>
                    <button class="share-btn" onclick="shareOn('twitter')">
                        <span class="share-icon">üê¶</span>
                        <span>Twitter</span>
                    </button>
                    <button class="share-btn" onclick="shareOn('facebook')">
                        <span class="share-icon">üìò</span>
                        <span>Facebook</span>
                    </button>
                    <button class="share-btn" onclick="shareOn('email')">
                        <span class="share-icon">‚úâÔ∏è</span>
                        <span>Email</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="stats">
            <div class="stats-title">Your Referral Stats</div>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-value" id="totalReferrals">0</div>
                    <div class="stat-label">Friends Referred</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="premiumDays">0</div>
                    <div class="stat-label">Days Premium Earned</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="yourRank">#--</div>
                    <div class="stat-label">Your Rank</div>
                </div>
            </div>
        </div>

        <div class="leaderboard">
            <div class="leaderboard-title">üèÜ Top Referrers This Month</div>
            <div class="leaderboard-item">
                <div class="rank">ü•á</div>
                <div class="user-info">
                    <div class="user-name">Maria G.</div>
                    <div class="user-referrals">127 referrals</div>
                </div>
                <div class="reward">Lifetime Premium</div>
            </div>
            <div class="leaderboard-item">
                <div class="rank">ü•à</div>
                <div class="user-info">
                    <div class="user-name">Carlos R.</div>
                    <div class="user-referrals">89 referrals</div>
                </div>
                <div class="reward">6 Months Free</div>
            </div>
            <div class="leaderboard-item">
                <div class="rank">ü•â</div>
                <div class="user-info">
                    <div class="user-name">Ana S.</div>
                    <div class="user-referrals">56 referrals</div>
                </div>
                <div class="reward">3 Months Free</div>
            </div>
        </div>
    </div>

    <script>
        // Generate unique referral code for user
        function generateReferralCode() {
            let code = localStorage.getItem('referralCode');
            if (!code) {
                code = 'REF' + Math.random().toString(36).substring(2, 8).toUpperCase();
                localStorage.setItem('referralCode', code);
            }
            return code;
        }

        // Initialize referral link
        const referralCode = generateReferralCode();
        const referralLink = `${window.location.origin}?ref=${referralCode}`;
        document.getElementById('referralLink').value = referralLink;

        // Load user stats
        function loadStats() {
            const totalReferrals = parseInt(localStorage.getItem('totalReferrals') || '0');
            const premiumDays = totalReferrals * 7; // 7 days per referral
            
            document.getElementById('totalReferrals').textContent = totalReferrals;
            document.getElementById('premiumDays').textContent = premiumDays;
            
            // Calculate rank (simplified)
            const rank = totalReferrals > 50 ? '1-10' : totalReferrals > 20 ? '11-50' : totalReferrals > 5 ? '51-100' : '100+';
            document.getElementById('yourRank').textContent = `#${rank}`;
        }

        // Copy link to clipboard
        function copyLink(event) {
            const input = document.getElementById('referralLink');
            const btn = event ? event.target : document.querySelector('.copy-btn');
            
            input.select();
            input.setSelectionRange(0, 99999); // Mobile
            
            navigator.clipboard.writeText(input.value).then(() => {
                const originalText = btn.textContent;
                btn.textContent = '‚úÖ Copied!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            }).catch(err => {
                console.error('Copy failed:', err);
                btn.textContent = '‚úÖ Copied!';
                setTimeout(() => {
                    btn.textContent = 'üìã Copy';
                }, 2000);
            });
        }

        // Share on social platforms
        function shareOn(platform) {
            const text = encodeURIComponent(`I'm learning Spanish with Langflix! Join me and we both get Premium free üöÄ`);
            const url = encodeURIComponent(referralLink);
            
            let shareUrl;
            switch(platform) {
                case 'whatsapp':
                    shareUrl = `https://wa.me/?text=${text}%20${url}`;
                    break;
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?text=${text}&url=${url}`;
                    break;
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
                    break;
                case 'email':
                    shareUrl = `mailto:?subject=Learn Spanish with me!&body=${text}%20${url}`;
                    break;
            }
            
            window.open(shareUrl, '_blank');
            
            // Track share
            trackShare(platform);
        }

        // Track share event
        function trackShare(platform) {
            const shares = JSON.parse(localStorage.getItem('referralShares') || '{}');
            shares[platform] = (shares[platform] || 0) + 1;
            localStorage.setItem('referralShares', JSON.stringify(shares));
            
            console.log(`Shared on ${platform}`);
        }

        // Check if user came from referral link
        function checkReferralLink() {
            const urlParams = new URLSearchParams(window.location.search);
            const refCode = urlParams.get('ref');
            
            if (refCode && refCode !== referralCode) {
                // User came from referral link
                console.log(`Referral from: ${refCode}`);
                localStorage.setItem('referredBy', refCode);
                
                // Give both users 7 days Premium
                givePremiumTrial(7);
                
                // Notify referrer (would be API call in production)
                alert('üéâ Welcome! You got 7 days of Premium free!');
            }
        }

        // Give premium trial
        function givePremiumTrial(days) {
            const expiryDate = new Date();
            expiryDate.setDate(expiryDate.getDate() + days);
            localStorage.setItem('premiumExpiry', expiryDate.getTime());
            localStorage.setItem('isPremium', 'true');
        }

        // Go back
        function goBack() {
            window.location.href = '/tiktok-video-feed.html';
        }

        // Initialize
        loadStats();
        checkReferralLink();
    </script>
    
    <!-- üß≠ UNIFIED BOTTOM NAVIGATION -->
    <style>
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-around;
            padding: 8px 0 max(8px, env(safe-area-inset-bottom));
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
        }
        .bottom-nav .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #666;
            text-decoration: none;
        }
        .bottom-nav .nav-item:hover {
            color: #007AFF;
            transform: translateY(-2px);
        }
        .bottom-nav .nav-item.active {
            color: #007AFF;
        }
        .bottom-nav .nav-icon {
            width: 24px;
            height: 24px;
        }
        .bottom-nav .nav-icon svg {
            width: 100%;
            height: 100%;
            stroke-width: 2;
        }
        .bottom-nav .nav-label {
            font-size: 11px;
            font-weight: 500;
        }
    </style>
    
    <nav class="bottom-nav">
        <a href="/tiktok-video-feed.html" class="nav-item">
            <div class="nav-icon">
                <svg viewBox="0 0 24 24" fill="currentColor" stroke="none">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
            </div>
            <div class="nav-label">Home</div>
        </a>
        <a href="/discover-ai.html" class="nav-item">
            <div class="nav-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
            </div>
            <div class="nav-label">Discover</div>
        </a>
        <a href="/vocabulary-review.html" class="nav-item">
            <div class="nav-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
                    <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                </svg>
            </div>
            <div class="nav-label">Review</div>
        </a>
        <a href="/games.html" class="nav-item">
            <div class="nav-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
            </div>
            <div class="nav-label">Games</div>
        </a>
        <a href="/refer-a-friend.html" class="nav-item active">
            <div class="nav-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <line x1="19" y1="8" x2="19" y2="14"></line>
                    <line x1="22" y1="11" x2="16" y2="11"></line>
                </svg>
            </div>
            <div class="nav-label">Refer</div>
        </a>
    </nav>
</body>
</html>
